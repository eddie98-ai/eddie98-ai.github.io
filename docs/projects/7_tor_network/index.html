<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <!-- Metadata, OpenGraph and Schema.org -->




<!-- Standard metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>
  
  
    
      TOR Network Detection via Machine Learning | Ahmad Debow (Edd)
    
  
</title>
<meta name="author" content="Ahmad  Debow">
<meta name="description" content="Building and evaluating machine learning classifiers to identify encrypted TOR network traffic from raw packet data.">

  <meta name="keywords" content="Ahmad Debow, AI, MLOps, DevOps, Machine Learning, Deep Learning, Generative Adversarial Networks, GANs, AWS, GCP, Cloud Computing, Python, Docker, GitLab, CI/CD, Computer Vision, NLP, Large Language Models, Biomedical AI, Intrusion Detection Systems">






  <!-- OpenGraph -->
  <meta property="og:site_name" content="Ahmad Debow (Edd)">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ahmad Debow (Edd) | TOR Network Detection via Machine Learning">
  <meta property="og:url" content="http://localhost:4000/projects/7_tor_network/">
  <meta property="og:description" content="Building and evaluating machine learning classifiers to identify encrypted TOR network traffic from raw packet data.">
  
  <meta property="og:locale" content="en">

  <!-- Twitter card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="TOR Network Detection via Machine Learning">
  <meta name="twitter:description" content="Building and evaluating machine learning classifiers to identify encrypted TOR network traffic from raw packet data.">
  
  





<!-- Bootstrap & MDB -->
<link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">



<!-- Fonts & Icons -->
<link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
<link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772">
<link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap">

<!-- Code Syntax Highlighting -->
<link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light">



<!-- Styles -->




  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%A0&lt;/text&gt;&lt;/svg&gt;">

<link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
<link rel="canonical" href="http://localhost:4000/projects/7_tor_network/">


  <!-- Dark Mode -->
  <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script>
  <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark">
  <script>
    initTheme();
  </script>










  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">
    <!-- Header -->
    <header>
  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/">
          Ahmad Debow (Edd)
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>

      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          

          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">About
              
            </a>
          </li>

          <!-- Other pages -->
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/publications/">publications
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item active">
                  <a class="nav-link" href="/projects/">projects
                    
                      <span class="sr-only">(current)</span>
                    
                  </a>
                </li>
              
            
          
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/cv/">cv
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/work/">work
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/teaching/">teaching
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  <a class="nav-link" href="/people/">references
                    
                  </a>
                </li>
              
            
          
            
          
          
          
            <!-- Toogle theme mode -->
            <li class="toggle-container">
              <button id="light-toggle" title="Change theme">
                <i class="ti ti-sun-moon" id="light-toggle-system"></i>
                <i class="ti ti-moon-filled" id="light-toggle-dark"></i>
                <i class="ti ti-sun-filled" id="light-toggle-light"></i>
              </button>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
  
    <!-- Scrolling Progress Bar -->
    <progress id="progress" value="0">
      <div class="progress-container">
        <span class="progress-bar"></span>
      </div>
    </progress>
  
</header>


    <!-- Content -->
    <div class="container mt-5" role="main">
      
        

<div class="post">
  <header class="post-header">
    <h1 class="post-title">TOR Network Detection via Machine Learning</h1>
    <p class="post-description">Building and evaluating machine learning classifiers to identify encrypted TOR network traffic from raw packet data.</p>
  </header>

  <article>
    <p>The TOR (The Onion Router) network provides anonymity by encrypting and routing internet traffic through a volunteer-operated network. While a vital tool for privacy, it is also exploited for malicious activities. The challenge is that TOR traffic is heavily encrypted, making it difficult to distinguish from normal HTTPS traffic using traditional methods. This project addresses this challenge by using machine learning to identify TOR flows based on their behavioral characteristics rather than their content.</p>

<hr>

<h3 id="1-data-collection-and-curation">1. Data Collection and Curation</h3>

<p>A significant part of this project was the creation of a high-quality, custom dataset for training and evaluation.</p>
<ul>
  <li>
<strong>Data Collection:</strong> Raw network traffic data was captured at Al-Sham Private University (ASPU), including a mix of standard HTTPS traffic and traffic specifically generated by browsing through the TOR network.</li>
  <li>
<strong>Data Curation:</strong> The captured data was processed to create two distinct datasets:
    <ol>
      <li>A newly curated dataset containing a balanced mix of TOR and non-TOR flows captured locally.</li>
      <li>A standard dataset used for benchmarking and validating the models’ performance against established results.</li>
    </ol>
  </li>
</ul>

<hr>

<h3 id="2-feature-engineering">2. Feature Engineering</h3>

<p>Since the packet content is encrypted, the core of the detection methodology relies on <strong>feature engineering</strong> from metadata and traffic flow characteristics. The goal is to find behavioral patterns that are unique to TOR traffic. Key engineered features included:</p>
<ul>
  <li>
<strong>Packet Size Statistics:</strong> Mean, standard deviation, and variance of packet sizes within a flow.</li>
  <li>
<strong>Inter-Arrival Times:</strong> The timing patterns between packets, which can differ significantly between TOR’s multi-hop routing and direct HTTPS connections.</li>
  <li>
<strong>Flow Duration and Volume:</strong> The total length and data volume of a communication session.</li>
  <li>
<strong>TLS Handshake Parameters:</strong> Metadata from the initial (unencrypted) TLS handshake, such as cipher suites offered.</li>
</ul>

<hr>

<h3 id="3-model-development-and-evaluation">3. Model Development and Evaluation</h3>

<p>Several machine learning classifiers were built and trained to distinguish between the encrypted TOR and non-TOR flows. The models included:</p>
<ul>
  <li>
<strong>Tree-based Models:</strong> Random Forest and Gradient Boosting, chosen for their ability to handle diverse feature types and their inherent explainability.</li>
  <li>
<strong>Support Vector Machines (SVM):</strong> Evaluated for their effectiveness in finding an optimal separating hyperplane in high-dimensional feature space.</li>
</ul>

<p>The models were rigorously evaluated on both the standard and the newly curated datasets, measuring their <strong>accuracy, precision, and recall</strong>. The results contributed to research in network security and traffic analysis by demonstrating the viability of using behavioral characteristics to identify encrypted TOR traffic with a high degree of confidence.</p>

<p><br></p>

<hr>
<h3 id="technical-summary">Technical Summary</h3>
<ul>
  <li>
<strong>Key Concepts:</strong> Network Traffic Analysis, Anomaly Detection, Encrypted Traffic Classification</li>
  <li>
<strong>Data Engineering:</strong> Custom Dataset Curation, Feature Engineering</li>
  <li>
<strong>ML Models:</strong> Random Forest, Gradient Boosting, SVM</li>
  <li>
<strong>Tools:</strong> Scapy, Pandas, Scikit-learn</li>
</ul>

  </article>

  

  
</div>

      
    </div>

    <!-- Footer -->
    


  <footer class="fixed-bottom" role="contentinfo">
    <div class="container mt-0">
      
  © Copyright 2025
  Ahmad
  
  Debow. 
  
  
    Last updated: August 09, 2025.
  

    </div>
  </footer>



    <!-- JavaScripts -->
    <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<!-- Bootsrap & MDB scripts -->
<script src="/assets/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>


  <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script>























  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>






<!-- Load Common JS -->
<script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script>
<script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script>
<script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script>

<!-- Jupyter Open External Links New Tab -->
<script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script>

<!-- Badges -->

  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>


  <script async src="https://badge.dimensions.ai/badge.js"></script>



  <!-- MathJax -->
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script>
  
    <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script>
    <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script>
  









  <!-- Scrolling Progress Bar -->
  <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script>







  <!-- Back to Top -->
  <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script>
  <script>
    addBackToTop();
  </script>






  </body>
</html>
